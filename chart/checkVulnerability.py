# -*- coding: utf-8 -*-

import subprocess

# URL
rohy = 'http://192.168.56.101/site_kill/'

pathNikto = 'C:\\Users\\Stephan\\Desktop\\program\\'

# CSV Out
output = 'C:\\Users\\\Stephan\\Desktop\\testNikto.csv'

cmd = 'perl ' + pathNikto + 'nikto.pl -h ' + rohy + ' -no404 -Format csv -output ' + output
subprocess.call(cmd, shell=True)

# Open result file and find CVE-line number
try:
    with open(output) as myFile:
        for num, line in enumerate(myFile, 1):
            if 'CVE-' in line:
                index = line.index('CVE-')
                cve_id = line[index:index+13]
                break

            else:
                cve_id = None

        print cve_id
except IOError:
    pass
